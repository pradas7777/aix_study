{% extends "base.html" %}

{% block title %}{{ board_title }} - AI+X ì‹ ë¦¼ í™”ì´íŒ… {% endblock %}

{% block content %}
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<h2>{{ board_title }}</h2>

<div class="card" style="background: #f0f7ff;">
    <div class="card" style="background: #f0f7ff;">
    <h3>ìƒˆ ê¸€ ì“°ê¸° </h3>
    <form action="/post/create" method="post" enctype="multipart/form-data" id="postForm">
        <input type="hidden" name="type" value="{{ post_type }}">
        <div><input type="text" name="title" placeholder="ì œëª©" required></div>
        
        <div id="drop-zone" style="border: 2px dashed #3498db; padding: 20px; text-align: center; background: #fff; cursor: pointer;">
            íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš” (ìµœëŒ€ 5ì¥)
            <input type="file" name="images" id="file-input" multiple accept="image/*" style="display: none;">
        </div>
        <div id="preview-container" style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;"></div>

        <div id="editor" style="height: 200px; background: white; margin-top: 10px;"></div>
        <input type="hidden" name="content" id="content">
        <button type="submit" class="btn" style="margin-top: 10px;">ì˜¬ë¦¬ê¸°</button>
    </form>
</div>
<script> // ì—ë””í„°ë¶€ë¶„
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');
    const previewContainer = document.getElementById('preview-container');

    dropZone.addEventListener('click', () => fileInput.click());

    fileInput.addEventListener('change', handleFiles);
    dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.style.background = '#e1f0fa'; });
    dropZone.addEventListener('dragleave', () => dropZone.style.background = '#fff');
    dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        fileInput.files = e.dataTransfer.files;
        handleFiles();
    });

    function handleFiles() {
        previewContainer.innerHTML = '';
        const files = Array.from(fileInput.files).slice(0, 5); // 5ì¥ ì œí•œ
        files.forEach(file => {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = document.createElement('img');
                img.src = e.target.result;
                img.style.width = '80px';
                img.style.height = '80px';
                img.style.objectFit = 'cover';
                img.style.borderRadius = '5px';
                previewContainer.appendChild(img);
            };
            reader.readAsDataURL(file);
        });
    }
</script>
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script>
    var quill = new Quill('#editor', {
        theme: 'snow',
        placeholder: 'ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...'
    });

    // í¼ ì œì¶œ ì‹œ ì—ë””í„° ë‚´ìš©ì„ ìˆ¨ê²¨ì§„ inputì— ë‹´ì•„ì¤ë‹ˆë‹¤.
    var form = document.getElementById('postForm');
    form.onsubmit = function() {
        var content = document.querySelector('input[name=content]');
        content.value = quill.root.innerHTML;
    };
</script>



{% for post in posts %}
<div class="card">
    <h3>
        <a href="/post/{{ post.id }}">{{ post.title }}</a>
        
        {# ê´€ë¦¬ìì¼ ë•Œë§Œ ì‚­ì œ ë²„íŠ¼ì„ ë³´ì—¬ì¤ë‹ˆë‹¤ #}
        {% if is_admin %}
        <form method="post" action="/post/{{ post.id }}/delete" 
              onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');" 
              style="display: inline; float: right;">
          <button type="submit" class="admin-delete-btn">ğŸ—‘ ì‚­ì œ</button>
        </form>
        {% endif %}
    </h3>
    
</div>
{% endfor %}
{% endblock %}
